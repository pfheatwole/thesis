*******************
Paraglider Canopies
*******************

The essential component of gliding flight is the lifting surface. For
a paraglider, lift is generated by an inflatable nylon parafoil, which uses
energy gained from gravity to generate useful aerodynamic forces by exchanging
momentum with the air.

Related Work
============

* Benedetti 2012, :cite:`benedetti2012ParaglidersFlightDynamics`

* "Paraglider Design Handbook", :cite:`casellasParagliderDesignHandbook`


Airfoil
=======

**Key terms and concepts to define in this section**: upper surface, lower
surface, leading edge, trailing edge, chord line, mean camber line, thickness,
thickness convention, 2D coefficients.


Geometry
--------

An airfoil is a 2D cross-section of a 3D wing.

.. figure:: figures/paraglider/geometry/airfoil/airfoil_examples.*

   Airfoils examples.

Here's a diagram of the basic airfoil geometric properties:

.. figure:: figures/paraglider/geometry/airfoil/airfoil_diagram.*
   :name: airfoil_diagram

   Airfoil geometry.


There are two conventions measuring the airfoil thickness; this convention
also determines what point is designated the *leading edge*. The leading and
trailing edge of a wing section are arbitrary points that define the *chord*;
the chord is used to nondimensionalize the airfoil geometry and define the
*angle of attack*.

.. figure:: figures/paraglider/geometry/airfoil/NACA-6412-thickness-conventions.*
   :name: airfoil_thickness

   Airfoil thickness conventions.


Coefficients
------------

NT


Chord Surface
=============

The chord surface is a conceptual curved surface produced by all the airfoil
chord lines. A wing geometry can be defined by a *chord surface* and an
*airfoil distribution*.

.. TODO:: define the *section index*

The surface can be defined using six curves as functions of the section index:

1. Chord length :math:`c(s)`

#. Geometric torsion :math:`\theta(s)`

#. Chord reference point for the xy-plane :math:`r_{xy}(s)`

#. Chord reference point for the yz-plane :math:`r_{yz}(s)`

#. Position of the reference point in the xy-plane :math:`x(s)`

#. Position of the reference point in the yz-plane :math:`\left< y(s),
   z(s)\right>`

These six functions define the scale, orientation, and position of each foil
section. Section scale is controlled by chord; each section profile is an
airfoil scaled by the chord length. Section orientation is controlled by
section 

.. TODO:: I should explicitly mention that with this set of definitions,
   section profiles will always "point" towards the +x-axis (mathematically,
   this means the plane containing each section will also contain the
   +x-axis). I'm pretty sure this is a reasonable constraint for most wing
   designs?

The chord length is the scaling factor. Geometric torsion rotates
section profile chords relative to their immediate neighboring sections.
Positions


What are the advantages of this parametric design?

* It's easy to query arbitrary points on the chord surface and foil surface,
  making it easy to integrate with existing aerodynamic methods (eg,
  Phillips).

* You can use (mostly) arbitrary functions for the curves, like linear
  interpolators or Bezier curves. This makes it easy to design custom curve
  shapes, and it makes it easy to recreate a geometry that was specified in
  points (like in Belloc). You can use Bezier curves if you want.

* It decouples design in the xy and yz planes, so as you design a shape
  towards a target, adjust one parameter doesn't break the previous work (eg,
  if you set the quarter-chord the way you want it you don't have to worry
  about changes to geometric torsion messing that up).

* As a generative model, it's easy to integrate into a CAD or 3D modeling
  program



Chord length
------------

NT


Geometric Torsion
-----------------

(One of the cool things about my geometry is that you don't need to specify
the rotation point. The airfoil angle is independent of the rotation point, so
it's unnecessary work to require a user to calculate positions relative to
rotation points.)

.. figure:: figures/paraglider/geometry/airfoil/geometric_torsion.*

   Geometric torsion.


Design in the xy-plane
----------------------

NT


Design in the yz-plane
----------------------

NT


Foil Surface
============

The chord surface is the flat surface produced by all the section chord. To
produce the 3D canopy, each section must be assigned an airfoil.


Examples
========

**FIXME**: doesn't this be belong to the "chord surface" section?


Flat Wings
----------

Example 1
^^^^^^^^^

First, design the set of reference curves to generate the target chord
surface:

.. figure:: figures/paraglider/geometry/canopy/examples/build/flat1_curves.*

Then assign an airfoil to produce the 3D wing:

(**FIXME: maybe show the chord surface just this first time?**)

.. figure:: figures/paraglider/geometry/canopy/examples/build/flat1_canopy.*

This is an idealized version of the target canopy because it has not accounted
for cell deformations, such as billowing.


Example 2
^^^^^^^^^

Words here.

.. figure:: figures/paraglider/geometry/canopy/examples/build/flat2_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/flat2_canopy.*


Example 3
^^^^^^^^^

Words here.

.. figure:: figures/paraglider/geometry/canopy/examples/build/flat3_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/flat3_canopy.*


Example 4
^^^^^^^^^

Words here.

.. figure:: figures/paraglider/geometry/canopy/examples/build/flat4_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/flat4_canopy.*


Elliptical Wings
----------------

Here's an example with a root-to-tip anhedral angle of 33 degrees.

.. figure:: figures/paraglider/geometry/canopy/examples/build/elliptical1_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/elliptical1_canopy.*


Here's another example with a root-to-tip anhedral angle of 44 degrees.

.. figure:: figures/paraglider/geometry/canopy/examples/build/elliptical2_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/elliptical2_canopy.*

And another with a root-to-tip anhedral angle of 44 degrees but a wingtip
anhedral angle of 89 degrees.

.. figure:: figures/paraglider/geometry/canopy/examples/build/elliptical3_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/elliptical3_canopy.*



The Manta
---------

The manta ray is a great demo for `r_xy`.

If :math:`r_x = 0`:

.. figure:: figures/paraglider/geometry/canopy/examples/build/manta1_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/manta1_canopy.*


If :math:`r_x = 0.5`:

.. figure:: figures/paraglider/geometry/canopy/examples/build/manta2_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/manta2_canopy.*


If :math:`r_x = 1`:

.. figure:: figures/paraglider/geometry/canopy/examples/build/manta3_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/manta3_canopy.*


Distortions
===========

**FIXME**: should I discuss cells, billowing, distortion, etc? I'm not working
on / implementing these, so they can probably go in the "Limitations" section
(whatever that turns out to be)

References:

* Babinksy (:cite:`babinsky1999AerodynamicPerformanceParagliders`) discusses
  the effect of billowing on flow separation, and
  :cite:`babinsky1999AerodynamicImprovementsParaglider` discusses using
  stiffeners to reduce the impact

* Kulhanek (:cite:`kulhanek2019IdentificationDegradationAerodynamic`) has
  brief discussion of these impacts

* Belloc (:cite:`belloc2016InfluenceAirInlet`) discusses the effects of air
  intakes, and suggests some modeling choices

* There are a bunch of papers on *fluid-structure interaction* modelling.

* Altmann (:cite:`altmann2009NumericalSimulationParafoil`) discusses the
  overall impact of cell billowing on glide performance, and has a great
  discussion of how design choices (cell structure, ribs, etc) can mitigate
  the problem; in future papers
  (:cite:`altmann2015FluidStructureInteractionAnalysis`,
  :cite:`altmann2019FluidStructureInteractionAnalysis`) he discusses
  implementation details. Fogell
  (:cite:`fogell2014FluidstructureInteractionSimulations`,
  :cite:`fogell2017FluidStructureInteractionSimulation`,
  :cite:`fogell2017FluidStructureInteractionSimulations`) has a lot to say
  on FSI, including some critique of the applicability of Altmann's method
  to parachutes.

  Another recent paper well worth reviewing (good discussions and great
  references list) is :cite:`lolies2019NumericalMethodsEfficient`, which is
  co-authored by Bruce Goldsmith! Neat. One of their big ideas seems to be
  using "mass-spring systems" from computer animation applications for
  paraglider cloth simulations.


Aerodynamics
============

The paraglider dynamics are complicated enough on their own, so for now I'm
splitting the canopy aerodynamics into their own section.


The classic method for estimating the aerodynamic performance of a wing is
Prandtl's *lifting-line theory* (LLT). This deceptively simple model allowed
analytical solutions to the lift distribution.

For wings with significant sweep and/or dihedral, the classic LLT breaks down.
These more complex geometries require adaptations to account for the
non-linear behaviors, resulting in *non-linear lifting line* (NLLT) theories.
These are often also known as "numerical" lifting-line theories, since they
require numerical solutions.


Inviscid methods
----------------

* It'd be cool to show a purely inviscid analysis first. Those are more common
  in many analyses, and more commonly applied to unusual geometry. I can use
  its poor performance to motivation Phillips' method. It also gives me the
  chance to introduce the method (since I'll need to discuss it at some point
  anyway before I compare it with Phillips).

* Notice there are a variety of limitations to my chosen inviscid model: see
  `https://www.xflr5.tech/docs/Part%20IV:%20Limitations.pdf`. When I say "this
  is what inviscid methods produce", what I really mean is "this is the
  performance of the particular inviscid method I applied"


Phillips' numerical lifting-line
--------------------------------

.. figure:: figures/paraglider/dynamics/phillips_scratch.*

   Wing sections for Phillips' method.


* In Phillips' original derivation they assumes uniform flow for Eq:5, but I'm
  using the non-uniform version from Hunsaker-Snyder Eq:5. Hunsaker mentions
  that this *local upstream velocity* `V_rel,i` "differs from the global
  freestream velocity `V_inf` in that it may also have contributions from
  prop-wash **or rotations of the lifting surface about the aircraft center of
  gravity.**" Is he implying that Phillips' method is useable as-is during
  rotations?

* I'm using airfoil data from XFOIL, which is unreliable post-stall, but I'm
  including significant post-stall coefficient data anyway to observe how
  Phillips' method behaves in those regions. It's useful to understand how the
  method behaves in post-stall regions in the event you have accurate
  post-stall airfoil data. (ignoring the fact that the 3D wing basically
  shoots that to heck anyway)

* By using section coefficient data, I'm ignoring cross-flow effects. I'm sure
  the arc of the wing has a significant effect on the boundary layer, which
  we're assuming is constant over the entire section.


Case Study
==========

(This is where I'll introduce Belloc's reference wing and wind tunnel data.
I can refer to it when I'm showing examples of the chord surface geometries as
an real-world application of the chord surface concept.)

Every new tool should be validated, and for aerodynamic codes validation often
involves comparing theoretical models to wind tunnel measurements. For the
tools proposed in this paper, validation should include demonstrating the
flexibility of the geometry definition proposed in :doc:`paraglider_canopies`
and the performance of the aerodynamics code proposed in
:ref:`paraglider_dynamics:Non-linear lifting line theory`.

An excellent test case for the geometry and aerodynamics is available from
:cite:`belloc2015WindTunnelInvestigation`, which provides both point-wise
geometry data and wind tunnel performance.


Geometry
--------

Chord Surface
^^^^^^^^^^^^^

.. list-table:: Full-scale wing dimensions
   :header-rows: 1

   * - Dimension
     - Value
     - Unit
   * - Arch height
     - 3.00
     - m
   * - Central chord
     - 2.80
     - m
   * - Projected area
     - 25.08
     - m\ :sup:`2`
   * - Projected span
     - 11.00
     - m
   * - Projected aspect ratio
     - 4.82
     - --
   * - Flat area
     - 28.56
     - m\ :sup:`2`
   * - Flat span
     - 13.64
     - m
   * - Flat aspect ratio
     - 6.52
     - --

The physical model was built at a quarter-scale. Physical dimensions and
positions were provided for the physical model.

.. csv-table:: Model wing geometry data at panel’s ends
   :header: :math:`i`, :math:`y_i` [m], :math:`z_i` [m], :math:`c_i` [m], Airfoil shifting location [%], Airfoil tilt angle [deg]

   0, -0.688,  0.000, 0.107, 60, 3
   1, -0.664, -0.097, 0.137, 60, 3
   2, -0.595, -0.188, 0.198, 60, 0
   3, -0.486, -0.265, 0.259, 60, 0
   4, -0.344, -0.325, 0.308, 60, 0
   5, -0.178, -0.362, 0.339, 60, 0
   6,  0.000, -0.375, 0.350, 60, 0
   7,  0.178, -0.362, 0.339, 60, 0
   8,  0.344, -0.325, 0.308, 60, 0
   9,  0.486, -0.265, 0.259, 60, 0
   10, 0.595, -0.188, 0.198, 60, 0
   11,  0.664, -0.097, 0.137, 60, 3
   12,  0.688,  0.000, 0.107, 60, 3

It is important to notice the difference between the section numbers used here
and the section indices used in the parafoil canopy geometry.

Also, the reference data is defined with the wing tips at :math:`z = 0`,
whereas the chord surface convention places the canopy origin at the leading
edge of the central section. This is easily accommodated by the chord surface
implementation, which simply shifts the origin to suit the final geometry.

.. TODO:: Should I use these tables or just give the explicit equations?
   They're messy, bu I do like the fact that they highlight the fact that you
   **can** use pointwise data.

Inputting the values to the canopy geometry produces:

.. raw:: latex

   \newpage

.. figure:: figures/paraglider/geometry/canopy/examples/build/belloc_curves.*

.. figure:: figures/paraglider/geometry/canopy/examples/build/belloc_canopy.*


Airfoils
^^^^^^^^

It uses a NACA 23015.

.. figure:: figures/paraglider/geometry/airfoil/NACA-23015.*

   NACA 23015



Aerodynamics
------------

(Compare the wind tunnel data against the NLLT and a *vortex lattice method*
(VLM) from XFLR5.

.. figure:: figures/paraglider/belloc/CL_vs_alpha.*

   Lift coefficient vs angle of attack.

.. figure:: figures/paraglider/belloc/CD_vs_alpha.*

   Lift coefficient vs angle of attack.

.. figure:: figures/paraglider/belloc/CM_vs_alpha.*

   Global pitching coefficient vs angle of attack.

This is the global pitching coefficient, which includes contributions from
both the section pitching coefficients and the aerodynamic forces. The VLM
estimate appears to be using the wrong reference point, but it isn't clear
from the program documentation what the error might be. The results are left
here for completeness and to highlight the uncertainty in how the VLM was
applied.

.. figure:: figures/paraglider/belloc/CL_vs_CD.*

   Lift coefficient vs drag coefficient.

.. figure:: figures/paraglider/belloc/CL_vs_CM.*

   Lift coefficient vs global pitching coefficient.
